{% load markup %}
{{ block.description|markdown }}

{% for question in block.question_set.all %}
<div class="cases">
     {{question.intro_text|markdown}}

     <div class="casetitle"> Question {{question.ordinality}}:</div>
     
     <div class="casecontent">
           <div class="casequestion">
                 {{question.text|markdown}}

		 {% if question.answerable %}
		 {% if block.rhetorical %}
                 <form id="form-{{question.id}}" method="post">
		 {% endif %}
                       <ol type="A">
			 {% for answer in question.answer_set.all %}
			 {% if block.rhetorical %}
			 {% if question.is_single_choice %}
                         <li><input name="question{{question.id}}" value="{{answer.label}}" type="radio" />{{answer.label}}</li>
			 {% else %}
                         <li><input name="question{{question.id}}" value="{{answer.label}}" type="checkbox" />{{answer.label}}</li>
			 {% endif %}
			 {% else %}
                         <li><input name="pageblock-{{block.pageblock.id}}-question{{question.id}}" value="{{answer.value}}" type="radio" />{{answer.label}}</li>
			 {% endif %}
			 {% endfor %}
                      </ol>
                 {% if block.rhetorical %}
                 </form>
		 {% endif %}
		 {% else %}

		 {% if question.is_short_text %}
  		   {% if block.rhetorical %}
		     <input type="text" name="question{{question.id}}" />
		   {% else %}
		     <input type="text" name="pageblock-{{block.pageblock.id}}-{{question.id}}" />
		   {% endif %}
		 {% endif %}

		 {% if question.is_long_text %}
  		   {% if block.rhetorical %}
		     <textarea rows="10" name="question{{question.id}}" ></textarea>
		   {% else %}
		     <textarea rows="10" name="pageblock-{{block.pageblock.id}}-{{question.id}}" ></textarea>
		   {% endif %}
		 {% endif %}



		 {% endif %}
           </div>
	   {% if question.answerable %}
	   {% if block.rhetorical %}
	   {% if question.is_single_choice %}
           <div class="casesanswerdisplay">
                 <a href="#q{{question.id}}" class="moretoggle">Show answer &gt;&gt;</a>
                 <div id="q{{question.id}}" class="toggleable">
                 <p>{% if question.correct_answer_letter %}<i>The
                 correct answer is
                 {{question.correct_answer_letter}}:</i>{% endif %} {{question.explanation|markdown}}</p>
                 </div>
           </div>
	   {% endif %}
	   {% if question.is_multiple_choice %}
	   <div class="casesanswerdisplay">
                 <a href="#q{{question.id}}" class="moretoggle">Show answer(s) &gt;&gt;</a>
                 <div id="q{{question.id}}" class="toggleable">
                 <p><i>The correct answer(s):</i></p>
		   <ol type="A">
		     {% for answer in question.answer_set.all %}
		     <li>{% if answer.correct %}
		       <span class="correctanswer">
			 {% else %}
			 <span class="incorrectanswer" %>
			 {% endif %}
		       <span class="answer-inner">{{answer.label}}</span></span></li>
		     {% endfor %}
		   </ol>

<p>{{question.explanation|markdown}}</p>
                 </div>
           </div>
	   {% endif %}
	   {% endif %}
	   {% else %}
	   {% comment %} short/long text questions {% endcomment %}

	   {% if block.rhetorical %}
	   {% if question.explanation %}
           <div class="casesanswerdisplay">
                 <a href="#q{{question.id}}" class="moretoggle">Show explanation &gt;&gt;</a>
                 <div id="q{{question.id}}" class="toggleable">
                 <p>{{question.explanation|markdown}}</p>
                 </div>
           </div>
	   {% endif %}
	   {% endif %}

	   {% endif %}
     </div>
</div> 
{% endfor %}

{% if block.rhetorical %}
<script src="http://mt.ccnmtl.columbia.edu/pedialabs/js/quizshow.js" type="text/javascript" language="javascript"></script>
{% endif %}	
